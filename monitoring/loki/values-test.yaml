# 최종 values.yaml for Minikube with MinIO (2차 수정본)

# deploymentMode를 명시적으로 'distributed'로 설정합니다.
deploymentMode: distributed

grafana:
  enabled: false

# ▼▼▼▼▼▼▼▼▼▼▼▼▼▼▼▼▼▼▼ 충돌을 일으키는 scalable 모드 컴포넌트 비활성화 ▼▼▼▼▼▼▼▼▼▼▼▼▼▼▼▼▼▼▼
backend:
  enabled: false
  replicas: 0

read:
  enabled: false
  replicas: 0

write:
  enabled: false
  replicas: 0

# ▲▲▲▲▲▲▲▲▲▲▲▲▲▲▲▲▲▲▲▲▲▲▲▲▲▲▲▲▲▲▲▲▲▲▲▲▲▲▲▲▲▲▲▲▲▲▲▲▲▲▲▲▲▲▲▲▲▲▲▲▲▲▲▲▲▲▲▲▲▲▲▲▲▲▲

# 'distributed' 모드에서 사용할 컴포넌트들
distributor:
  replicas: 1
  resources:
    requests:
      cpu: 50m
      memory: 128Mi
    limits:
      cpu: 100m
      memory: 256Mi

ingester:
  replicas: 1
  resources:
    requests:
      cpu: 100m
      memory: 256Mi
    limits:
      cpu: 500m
      memory: 512Mi
  chunk_idle_period: 30m
  chunk_target_size: 1MB
  max_chunk_age: 30m

querier:
  replicas: 1
  resources:
    requests:
      cpu: 50m
      memory: 128Mi
    limits:
      cpu: 100m
      memory: 256Mi

compactor:
  enabled: false

loki:
  useTestSchema: true
  limits_config:
    allow_structured_metadata: true
    retention_period: 7d
    ingestion_rate_mb: 5
    ingestion_burst_size_mb: 10
    max_entries_limit_per_query: 5000
    max_cache_freshness_per_query: 10m
    max_query_length: 168h
    max_query_parallelism: 16
    max_streams_per_user: 1000
    max_line_size: 128KB
    reject_old_samples: true
    reject_old_samples_max_age: 24h

  storage:
    type: 's3'
    bucketNames:
      chunks: "loki-chunks"
      ruler: "loki-ruler"
      admin: "loki-admin"
    s3:
      endpoint: "http://minio.minio.svc.cluster.local:9000"
      insecure: true
      accessKeyId: "minioadmin"
      secretAccessKey: "minioadmin123"
      s3ForcePathStyle: true

  serviceAccount:
    create: true
    annotations: {}

serviceMonitor:
  enabled: true
  interval: 30s